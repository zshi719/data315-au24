---
editor_options:
  markdown:
    wrap: 72
output:
  html_document:
    df_print: paged
  pdf_document: default
---

```{r,include=FALSE}
knitr::opts_chunk$set(digits.signif = 4, tidy = TRUE, tidy.opts=list(blank = FALSE, warning = FALSE), message = TRUE, echo = TRUE, width='80%', widt.cutoff = '80')
```

# S&P 500 Top 50 Components by Market Cap

```{r,include=FALSE}
library(janitor)
library(gridExtra)
library(grid)
library(rvest)
library(knitr)
library(tidyquant)
library(purrr)
library(writexl)
library(tidyr)
library(knitr)
library(dplyr)
library(timeR)
conflicted::conflict_prefer("mutate", "dplyr")
conflicted::conflict_prefer("filter", "dplyr")
conflicted::conflict_prefer("lag", "dplyr")
library(rcartocolor)
nColor <- 12
ticker_colors <- carto_pal(12, "Safe")
ticker_colors <- c("#88CCEE", "#CC6677", "#DDCC77" ,"#117733", "#332288" ,"#AA4499","#999933" ,"#44AA99", "#882255", "#6699CC", "#888888")

```

```{r, eval=FALSE}
top50_symbol = c("AAPL", "NVDA", "MSFT", "AMZN", "META", "GOOGL", "BRK-B","AVGO", 
             "GOOG", "LLY", "JPM", "TSLA", "XOM", "UNH", "V", "MA", "HD", "PG", 
             "COST", "JNJ", "WMT", "NFLX", "ABBV", "CRM", "BAC", "ORCL", "MRK", 
             "KO", "CVX", "AMD", "PEP", "ACN", "LIN", "CSCO", "TMO", "MCD", 
             "ADBE", "WFC", "IBM", "GE", "ABT", "CAT", "NOW", "QCOM", "PM", 
             "ISRG", "VZ", "TXN", "DIS", "DHR")
```

```{r, eval=FALSE}
pull_stock_data <- function(symbol) {
  stock_data <- tryCatch({
    tq_get(top50_symbol, from = "2022-12-31") %>%
      as.data.frame() %>% 
      mutate(daily_return = (adjusted / lag(adjusted) - 1) * 100) %>% na.omit()
  }, error = function(e) {
    return(NULL)
  })
  
  
  return(stock_data)
}
```

```{r, eval=FALSE,warning=FALSE}
timer <- createTimer(precision = "ms") 
timer$start("e")

data <- pull_stock_data(top50_symbol)

timer$stop("e")

stock_data_list <- split(data, data$symbol)


write_xlsx(stock_data_list, "stock_data_by_company.xlsx")



timer$getTimeElapsed("e")

```

[S&P 500 ETF Components List shows the holdings of the SPDR S&P 500 ETF
Trust (SPY)](https://www.slickcharts.com/sp500 "S&P 500 ETF Components")

|   | Company | Symbol | Weight |
|:-----|:------------------------------|:-----------|:--------|
| 1 | [Apple Inc.](https://www.slickcharts.com/symbol/AAPL) | [AAPL](https://www.slickcharts.com/symbol/AAPL) | 7.26% |
| 2 | [Nvidia Corp](https://www.slickcharts.com/symbol/NVDA) | [NVDA](https://www.slickcharts.com/symbol/NVDA) | 7.14% |
| 3 | [Microsoft Corp](https://www.slickcharts.com/symbol/MSFT) | [MSFT](https://www.slickcharts.com/symbol/MSFT) | 6.29% |
| 4 | [Amazon.com Inc](https://www.slickcharts.com/symbol/AMZN) | [AMZN](https://www.slickcharts.com/symbol/AMZN) | 3.57% |
| 5 | [Meta Platforms, Inc. Class A](https://www.slickcharts.com/symbol/META) | [META](https://www.slickcharts.com/symbol/META) | 2.54% |
| 6 | [Alphabet Inc. Class A](https://www.slickcharts.com/symbol/GOOGL) | [GOOGL](https://www.slickcharts.com/symbol/GOOGL) | 1.94% |
| 7 | [Berkshire Hathaway Class B](https://www.slickcharts.com/symbol/BRK.B) | [BRK.B](https://www.slickcharts.com/symbol/BRK.B) | 1.72% |
| 8 | [Broadcom Inc.](https://www.slickcharts.com/symbol/AVGO) | [AVGO](https://www.slickcharts.com/symbol/AVGO) | 1.69% |
| 9 | [Alphabet Inc. Class C](https://www.slickcharts.com/symbol/GOOG) | [GOOG](https://www.slickcharts.com/symbol/GOOG) | 1.61% |
| 10 | [Eli Lilly & Co.](https://www.slickcharts.com/symbol/LLY) | [LLY](https://www.slickcharts.com/symbol/LLY) | 1.44% |
| 11 | [Jpmorgan Chase & Co.](https://www.slickcharts.com/symbol/JPM) | [JPM](https://www.slickcharts.com/symbol/JPM) | 1.28% |
| 12 | [Tesla, Inc.](https://www.slickcharts.com/symbol/TSLA) | [TSLA](https://www.slickcharts.com/symbol/TSLA) | 1.23% |
| 13 | [Exxon Mobil Corporation](https://www.slickcharts.com/symbol/XOM) | [XOM](https://www.slickcharts.com/symbol/XOM) | 1.08% |
| 14 | [Unitedhealth Group Incorporated](https://www.slickcharts.com/symbol/UNH) | [UNH](https://www.slickcharts.com/symbol/UNH) | 1.07% |
| 15 | [Visa Inc.](https://www.slickcharts.com/symbol/V) | [V](https://www.slickcharts.com/symbol/V) | 0.97% |
| 16 | [Mastercard Incorporated](https://www.slickcharts.com/symbol/MA) | [MA](https://www.slickcharts.com/symbol/MA) | 0.86% |
| 17 | [Home Depot, Inc.](https://www.slickcharts.com/symbol/HD) | [HD](https://www.slickcharts.com/symbol/HD) | 0.81% |
| 18 | [Procter & Gamble Company](https://www.slickcharts.com/symbol/PG) | [PG](https://www.slickcharts.com/symbol/PG) | 0.81% |
| 19 | [Costco Wholesale Corp](https://www.slickcharts.com/symbol/COST) | [COST](https://www.slickcharts.com/symbol/COST) | 0.79% |
| 20 | [Johnson & Johnson](https://www.slickcharts.com/symbol/JNJ) | [JNJ](https://www.slickcharts.com/symbol/JNJ) | 0.79% |
| 21 | [Walmart Inc.](https://www.slickcharts.com/symbol/WMT) | [WMT](https://www.slickcharts.com/symbol/WMT) | 0.71% |
| 22 | [Netflix Inc](https://www.slickcharts.com/symbol/NFLX) | [NFLX](https://www.slickcharts.com/symbol/NFLX) | 0.67% |
| 23 | [Abbvie Inc.](https://www.slickcharts.com/symbol/ABBV) | [ABBV](https://www.slickcharts.com/symbol/ABBV) | 0.67% |
| 24 | [Salesforce, Inc.](https://www.slickcharts.com/symbol/CRM) | [CRM](https://www.slickcharts.com/symbol/CRM) | 0.57% |
| 25 | [Bank of America Corporation](https://www.slickcharts.com/symbol/BAC) | [BAC](https://www.slickcharts.com/symbol/BAC) | 0.57% |
| 26 | [Oracle Corp](https://www.slickcharts.com/symbol/ORCL) | [ORCL](https://www.slickcharts.com/symbol/ORCL) | 0.56% |
| 27 | [Merck & Co., Inc.](https://www.slickcharts.com/symbol/MRK) | [MRK](https://www.slickcharts.com/symbol/MRK) | 0.54% |
| 28 | [Coca-Cola Company](https://www.slickcharts.com/symbol/KO) | [KO](https://www.slickcharts.com/symbol/KO) | 0.54% |
| 29 | [Chevron Corporation](https://www.slickcharts.com/symbol/CVX) | [CVX](https://www.slickcharts.com/symbol/CVX) | 0.52% |
| 30 | [Advanced Micro Devices](https://www.slickcharts.com/symbol/AMD) | [AMD](https://www.slickcharts.com/symbol/AMD) | 0.52% |
| 31 | [Pepsico, Inc.](https://www.slickcharts.com/symbol/PEP) | [PEP](https://www.slickcharts.com/symbol/PEP) | 0.49% |
| 32 | [Accenture Plc](https://www.slickcharts.com/symbol/ACN) | [ACN](https://www.slickcharts.com/symbol/ACN) | 0.48% |
| 33 | [Linde Plc](https://www.slickcharts.com/symbol/LIN) | [LIN](https://www.slickcharts.com/symbol/LIN) | 0.47% |
| 34 | [Cisco Systems, Inc.](https://www.slickcharts.com/symbol/CSCO) | [CSCO](https://www.slickcharts.com/symbol/CSCO) | 0.46% |
| 35 | [Thermo Fisher Scientific, Inc.](https://www.slickcharts.com/symbol/TMO) | [TMO](https://www.slickcharts.com/symbol/TMO) | 0.46% |
| 36 | [Mcdonald's Corporation](https://www.slickcharts.com/symbol/MCD) | [MCD](https://www.slickcharts.com/symbol/MCD) | 0.46% |
| 37 | [Adobe Inc.](https://www.slickcharts.com/symbol/ADBE) | [ADBE](https://www.slickcharts.com/symbol/ADBE) | 0.45% |
| 38 | [Wells Fargo & Co.](https://www.slickcharts.com/symbol/WFC) | [WFC](https://www.slickcharts.com/symbol/WFC) | 0.44% |
| 39 | [International Business Machines Corporation](https://www.slickcharts.com/symbol/IBM) | [IBM](https://www.slickcharts.com/symbol/IBM) | 0.43% |
| 40 | [Ge Aerospace](https://www.slickcharts.com/symbol/GE) | [GE](https://www.slickcharts.com/symbol/GE) | 0.43% |
| 41 | [Abbott Laboratories](https://www.slickcharts.com/symbol/ABT) | [ABT](https://www.slickcharts.com/symbol/ABT) | 0.41% |
| 42 | [Caterpillar Inc.](https://www.slickcharts.com/symbol/CAT) | [CAT](https://www.slickcharts.com/symbol/CAT) | 0.38% |
| 43 | [Servicenow, Inc.](https://www.slickcharts.com/symbol/NOW) | [NOW](https://www.slickcharts.com/symbol/NOW) | 0.38% |
| 44 | [Qualcomm Inc](https://www.slickcharts.com/symbol/QCOM) | [QCOM](https://www.slickcharts.com/symbol/QCOM) | 0.38% |
| 45 | [Philip Morris International Inc.](https://www.slickcharts.com/symbol/PM) | [PM](https://www.slickcharts.com/symbol/PM) | 0.37% |
| 46 | [Intuitive Surgical Inc.](https://www.slickcharts.com/symbol/ISRG) | [ISRG](https://www.slickcharts.com/symbol/ISRG) | 0.37% |
| 47 | [Verizon Communications](https://www.slickcharts.com/symbol/VZ) | [VZ](https://www.slickcharts.com/symbol/VZ) | 0.37% |
| 48 | [Texas Instruments Incorporated](https://www.slickcharts.com/symbol/TXN) | [TXN](https://www.slickcharts.com/symbol/TXN) | 0.36% |
| 49 | [The Walt Disney Company](https://www.slickcharts.com/symbol/DIS) | [DIS](https://www.slickcharts.com/symbol/DIS) | 0.35% |
| 50 | [Danaher Corporation](https://www.slickcharts.com/symbol/DHR) | [DHR](https://www.slickcharts.com/symbol/DHR) | 0.35% |
